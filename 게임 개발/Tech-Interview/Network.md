# Network

## TCP

TCP는 연결지항형 서비스(reliabel service)와 `신뢰적 데이터 전송 서비스(data integrity)`를 포함한다.

### TCP의 특징

용어는 외울 필요 없지만 내용은 외울 필요 있다.

**reliabel service**

TCP는 메시지 전송 전에 클라이언트와 서버가 서로 전송 제어 정보를 교환하도록 한다. 즉, 패킷이 전송될 것을 미리 알려준다.

**data integrity**

TCP는 데이터를 오류 없이 올바른 순서로 전달하는 것을 보장한다.

**congestion conrtrol(혼잡 제어)**

TCP는 네트워크가 혼잡상태에 이르면 혼잡제어를 통해 프로세스의 속도를 낮춘다. 즉, 프로세스가 우선이 아니라 네트워크의 안정성 향상을 우선한다.

**flow control(흐름제어)**

TCP는 receiver의 buffer가 꽉 차서 데이터가 손실되지 않도록 sender의 전송을 관리한다.



요약하자면 TCP는 최대한 오류 없는 신뢰성 있는 전송을 위해 많은 기능을 지원하며, 이에 따라 속도가 UDP에 비해 불리할 수 있지만, 안정적이고 정확한 패킷 전달을 보장한다는 특징이 있다.

### TCP의 사용처

HTTP, 신뢰성 있는 데이터 전송이 필요한 대부분의 서비스에 사용된다. 게임도 대개 TCP를 사용한다.

## UDP

최소의 서비스 모델을 가진 간단한 프로토콜이다. 비연결형임으로 핸드셰이킹을 하지 않는다.

비신뢰적인 서비스이므로 데이터가 손상될 수 있다. UDP는 flow control을 하지 않으므로 프로세스는 원하는 속도로 하위 계층으로 보낼 수 있다. 그외 올바른 패킷 전송에 필요한 여러가지 제어를 전부 하지 않는다.

데이터그램을 생성하며, 데이터 전송의 신뢰성을 보장하지 않는다. 비연결형이고, 데이터를 보내고 신경쓰지 않는다. 재전송 또한 없다.

그래서 TCP보다 비교적 빠르다. 연결 상태를 만들지 않으므로 유지할 필요도 없다.

또한 패킷이 순서대로 오는 것을 보장하지 않기 때문에 수신자가 헤더를 보고 조합해야 한다.

최소한의 오류검출은 한다. 그렇다고 오류가 있으니 다시 보내달라고 하진 않는다.

요약하자면 **TCP보단 빠르지만 안전하지 못하다. 패킷 유실이 가능하다.**

### UDP의 사용처

DNS, 패킷 에러에 민감하지 않은 음성 통화, 비디오 서비스, 화상 통화 등

## Nagle 알고리즘

TCP 네트워크에서, 데이터는 OSI레이어를 거치면서 몇 겹의 헤더로 캡슐화되어 목적지로 보내진다. 또한, 패킷전송에는 비용이 따른다. 이런 경우 데이터가 적다면 보내는 효율이 떨어지게 된다. 적은 데이터를 가진 패킷을 여러번 보내는 것보다는 많은 데이터를 가진 패킷을 한번에 보내는 것이 효율이 좋다. (네트워크 부하가 적어진다) 이럴 경우, 상대가 받을 수 있는 사이즈 (window size) 가 충분하다면 크기가 작은 패킷을 모아서 보내는 것을 Nagle 알고리즘이라고 한다.

이렇게 보내면 전송의 효율이 증가하지만, 즉각적인 반응이 필요한 네트워크 게임 등에는 적합하지 않다. (점프 입력을 세번 해야 패킷이 간다고 하면..?) 즉 네트워크 겡미에서는 Nagle 알고리즘을 off해야 한다.

이는 패킷 전송 제어에 관한 구현이므로, UDP에서는 사용할 수 없다.